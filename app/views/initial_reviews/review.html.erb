<div class="container mt-4">
  <h1>Review Application</h1>

  <%= render 'review_buttons', application: @application %>

  <div class="card mb-4">
    <div class="card-body">
      <% if @application.resume.present? %>
        <div class="resume-preview mb-4" style="width: 100%; height: 600px;">
          <iframe 
            src="https://drive.google.com/file/d/<%= @application.resume.split('id=').last %>/preview"
            style="width: 100%; height: 100%; border: none;"
            allow="autoplay">
          </iframe>
        </div>
      <% end %>

      <table class="table table-bordered">
        <tbody>
          <% Application.displayable_columns.each_slice(2) do |left_col, right_col| %>
            <tr>
              <% if left_col %>
                <th class="bg-light" style="width: 20%"><%= left_col.humanize %></th>
                <td style="width: 30%">
                  <% if left_col == "resume" && @application.resume.present? %>
                    <%= link_to @application.resume, @application.resume, target: "_blank" %>
                  <% else %>
                    <%= @application.send(left_col) %>
                  <% end %>
                </td>
              <% end %>
              
              <% if right_col %>
                <th class="bg-light" style="width: 20%"><%= right_col.humanize %></th>
                <td style="width: 30%">
                  <% if right_col == "resume" && @application.resume.present? %>
                    <%= link_to @application.resume, @application.resume, target: "_blank" %>
                  <% else %>
                    <%= @application.send(right_col) %>
                  <% end %>
                </td>
              <% end %>
            </tr>
          <% end %>
        </tbody>
      </table>

      <% if @application.initial_reviews.any? %>
        <div class="mt-4">
          <h4>Existing Reviews</h4>
          <div class="review-boxes">
            <% @application.initial_reviews.each do |review| %>
              <div class="review-box review-<%= review.decision %>" 
                   title="Reviewed by <%= review.reviewer %>: <%= review.decision.upcase %>">
              </div>
            <% end %>
          </div>
        </div>
      <% end %>
    </div>
  </div>

  <%= render 'review_buttons', application: @application %>
</div> 